y=0.85*max(plotDFAnom$anom,na.rm=TRUE),
color="blue",
size=3.5)
CplotListAnom[[covars[j]]] = ggplot(plotDFAnom
)+geom_point(aes(x=C,y=anom)
)+labs(y=covars[j],x=NULL
)+geom_text(label=as.character(round(CcorrAnom,digits=3)),
x=0.85*max(plotDFAnom$C,na.rm=TRUE),
y=0.85*max(plotDFAnom$anom,na.rm=TRUE),
color="blue",
size=3.5)
}
png(file=paste(getwd(),'/EcologicalNichePlots/',sites[i],'_AEddyInfluence.png',sep=""),height=700,width=600,units="px",res=100)
grid.arrange(grobs=AplotList,ncol=2,nrow=5,top=sites[i])
while (dev.cur()>1) {dev.off()}
png(file=paste(getwd(),'/EcologicalNichePlots/',sites[i],'_CEddyInfluence.png',sep=""),height=700,width=600,units="px",res=100)
grid.arrange(grobs=CplotList,ncol=2,nrow=5,top=sites[i])
while (dev.cur()>1) {dev.off()}
png(file=paste(getwd(),'/EcologicalNichePlots/',sites[i],'_AEddyInfluence_Anom.png',sep=""),height=700,width=600,units="px",res=100)
grid.arrange(grobs=AplotListAnom,ncol=2,nrow=5,top=sites[i])
while (dev.cur()>1) {dev.off()}
png(file=paste(getwd(),'/EcologicalNichePlots/',sites[i],'_CEddyInfluence_Anom.png',sep=""),height=700,width=600,units="px",res=100)
grid.arrange(grobs=CplotListAnom,ncol=2,nrow=5,top=sites[i])
while (dev.cur()>1) {dev.off()}
}
View(ACorrMat)
rownames(ACorrMat) = sites
rownames(CCorrMat) = sites
rownames(ACorrMatAn) = sites
rownames(CCorrMatAn) = sites
colnames(ACorrMat) = covars
colnames(ACCorrMat) = covars
colnames(ACorrMatAn) = covars
colnames(CCorrMatAn) = covars
rownames(ACorrMat) = sites
rownames(CCorrMat) = sites
rownames(ACorrMatAn) = sites
rownames(CCorrMatAn) = sites
colnames(ACorrMat) = covars
colnames(ACorrMat) = covars
colnames(ACorrMatAn) = covars
colnames(CCorrMatAn) = covars
View(ACorrMat)
library(corrplot)
corrplot(ACorrMat,method='circle')
corrplot(ACorrMat,method='circle',is.corr=FALSE)
paste('AEddyDist_',sites,sep="")
rownames(ACorrMat) = paste('AEddyDist_',sites,sep="")
corrplot(ACorrMat,method='circle')
rownames(ACorrMat) = paste('AEddyDist_',sites,sep="")
rownames(CCorrMat) = paste('CEddyDist_',sites,sep="")
rownames(ACorrMatAn) = paste('AEddyDist_',sites,sep="")
rownames(CCorrMatAn) = paste('CEddyDist_',sites,sep="")
colnames(ACorrMat) = covars
colnames(ACorrMat) = covars
colnames(ACorrMatAn) = covars
colnames(CCorrMatAn) = covars
colnames(ACorrMatAn) = paste(covars,'_Anom',sep="")
colnames(CCorrMatAn) = paste(covars,'_Anom',sep="")
corrPlotList = list(corrplot(ACorrMat,method='circle'),
corrplot(CCorrMat,method='circle'),
corrplot(ACorrMatAn,method='circle'),
corrplot(CCorrMatAn,method='circle'))
grid.arrange(grobs=corrPlotList,nrow=2,ncol=2)
View(corrPlotList)
corrPlotList = list(ACorr = corrplot(ACorrMat,method='circle'),
CCorr = corrplot(CCorrMat,method='circle'),
ACorrAn = corrplot(ACorrMatAn,method='circle'),
CCorrAn = corrplot(CCorrMatAn,method='circle'))
grid.arrange(grobs=corrPlotList,nrow=2,ncol=2)
View(corrPlotList)
ACorr = corrplot(ACorrMat,method='circle')
CCorr = corrplot(CCorrMat,method='circle')
ACorrAn = corrplot(ACorrMatAn,method='circle')
CCorrAn = corrplot(CCorrMatAn,method='circle')
grid.arrange(ACorr,CCorr,ACorrAn,CCorrAn,nrow=2,ncol=2)
ACorr = as.grob(corrplot(ACorrMat,method='circle'))
CCorr = as.grob(corrplot(CCorrMat,method='circle'))
ACorrAn = as.grob(corrplot(ACorrMatAn,method='circle'))
library(grid)
ACorr = as.grob(corrplot(ACorrMat,method='circle'))
install.packages("ggplotify")
library(ggplotify)
ACorr = as.grob(corrplot(ACorrMat,method='circle'))
install.packages("gridGraphics")
install.packages("gridGraphics")
library(gridGraphics)
corrplot(ACorrMat,method='circle')
grid.echo()
ACorr = grid.grab()
corrplot(CCorrMat,method='circle')
grid.echo()
CCorr = grid.grab()
corrplot(ACorrMatAn,method='circle')
grid.echo()
ACorrAn = grid.grab()
corrplot(CCorrMatAn,method='circle')
grid.echo()
CCorrAn = grid.grab()
ACorr
grid.draw(ACorr)
grid.draw(ACorrAn)
par(mfrow=c(2,2))
corrplot(ACorrMat,method='circle')
corrplot(CCorrMat,method='circle')
corrplot(ACorrMatAn,method='circle')
corrplot(CCorrMatAn,method='circle')
rownames(ACorrMat) = paste('AEddyDist_',sites,sep="")
rownames(CCorrMat) = paste('CEddyDist_',sites,sep="")
rownames(ACorrMatAn) = paste('AEddyDist_',sites,sep="")
rownames(CCorrMatAn) = paste('CEddyDist_',sites,sep="")
colnames(ACorrMat) = covars
colnames(CCorrMat) = covars
colnames(ACorrMatAn) = paste(covars,'_Anom',sep="")
colnames(CCorrMatAn) = paste(covars,'_Anom',sep="")
par(mfrow=c(2,2))
corrplot(ACorrMat,method='circle')
corrplot(CCorrMat,method='circle')
corrplot(ACorrMatAn,method='circle')
corrplot(CCorrMatAn,method='circle')
colnames(ACorrMatAn) = covars
colnames(CCorrMatAn) = covars
par(mfrow=c(2,2))
corrplot(ACorrMat,method='circle')
corrplot(CCorrMat,method='circle')
corrplot(ACorrMatAn,method='circle')
corrplot(CCorrMatAn,method='circle')
rownames(ACorrMat) = paste('AEddyDist_',sites,sep="")
rownames(CCorrMat) = paste('CEddyDist_',sites,sep="")
rownames(ACorrMatAn) = paste('AEddyDist_',sites,sep="")
rownames(CCorrMatAn) = paste('CEddyDist_',sites,sep="")
colnames(ACorrMat) = covars
colnames(CCorrMat) = covars
colnames(ACorrMatAn) = covars
colnames(CCorrMatAn) = covars
png(file='/EcologicalNichePlots/EddyDistCorrelations.png',height=600,width=600,units="px",res=150)
par(mfrow=c(2,2))
corrplot(ACorrMat,method='circle')
corrplot(CCorrMat,method='circle')
corrplot(ACorrMatAn,method='circle')
corrplot(CCorrMatAn,method='circle')
while (dev.cur()>1) {dev.off()}
dev.off()
dev.off()
png(file='/EcologicalNichePlots/EddyDistCorrelations.png',height=600,width=600,units="px",res=150)
par(mfrow=c(2,2))
corrplot(ACorrMat,method='circle')
corrplot(CCorrMat,method='circle')
corrplot(ACorrMatAn,method='circle')
corrplot(CCorrMatAn,method='circle')
while (dev.cur()>1) {dev.off()}
png(file='EddyDistCorrelations.png',height=600,width=600,units="px",res=150)
par(mfrow=c(2,2))
corrplot(ACorrMat,method='circle')
corrplot(CCorrMat,method='circle')
corrplot(ACorrMatAn,method='circle')
corrplot(CCorrMatAn,method='circle')
while (dev.cur()>1) {dev.off()}
png(file='EddyDistCorrelations.png',height=600,width=600,units="px",res=125)
par(mfrow=c(2,2))
corrplot(ACorrMat,method='circle')
corrplot(CCorrMat,method='circle')
corrplot(ACorrMatAn,method='circle')
corrplot(CCorrMatAn,method='circle')
while (dev.cur()>1) {dev.off()}
png(file='EddyDistCorrelations.png',height=600,width=600,units="px",res=100)
par(mfrow=c(2,2))
corrplot(ACorrMat,method='circle')
corrplot(CCorrMat,method='circle')
corrplot(ACorrMatAn,method='circle')
corrplot(CCorrMatAn,method='circle')
while (dev.cur()>1) {dev.off()}
png(file='EddyDistCorrelations.png',height=600,width=600,units="px",res=75)
par(mfrow=c(2,2))
corrplot(ACorrMat,method='circle')
corrplot(CCorrMat,method='circle')
corrplot(ACorrMatAn,method='circle')
corrplot(CCorrMatAn,method='circle')
while (dev.cur()>1) {dev.off()}
sites = unique(weeklyDF$Site)
covars = c("Chl0","EKE0","FSLE0","SSH0","Temp0","Sal0",
"VelMag0","VelAsp0")
ACorrMat = matrix(nrow=length(sites),ncol=length(covars))
CCorrMat = matrix(nrow=length(sites),ncol=length(covars))
ACorrMatAn = matrix(nrow=length(sites),ncol=length(covars))
CCorrMatAn = matrix(nrow=length(sites),ncol=length(covars))
for (i in 1:length(sites)){
siteInd = which(weeklyDF$Site==sites[i])
AplotList = list()
CplotList = list()
AplotListAnom = list()
CplotListAnom = list()
for (j in 1:length(covars)){
if (covars[j]!="EKE0"){ # don't calculate anomaly for EKE (it's already an anomaly)
varMean = rollmean(weeklyDF[[covars[j]]][siteInd],k=5)
varAnom = weeklyDF[[covars[j]]][siteInd] - c(NA,NA,varMean,NA,NA)
} else {
varAnom = weeklyDF[[covars[j]]][siteInd]
}
plotDF = data.frame(var=weeklyDF[[covars[j]]][siteInd],A=weeklyDF$AEddyDist0[siteInd],C=weeklyDF$CEddyDist0[siteInd])
Acorr = cor(plotDF$var,plotDF$A,use="complete.obs")
ACorrMat[i,j] = round(Acorr,digits=4)
Ccorr = cor(plotDF$var,plotDF$C,use="complete.obs")
CCorrMat[i,j] = round(Ccorr,digits=4)
plotDFAnom = data.frame(anom=varAnom,A=weeklyDF$AEddyDist0[siteInd],C=weeklyDF$CEddyDist0[siteInd])
AcorrAnom = cor(plotDFAnom$anom,plotDFAnom$A,use="complete.obs")
ACorrMatAn[i,j] = round(AcorrAnom,digits=4)
CcorrAnom = cor(plotDFAnom$anom,plotDFAnom$C,use="complete.obs")
CCorrMatAn[i,j] = round(CcorrAnom,digits=4)
AplotList[[covars[j]]] = ggplot(plotDF
)+geom_point(aes(x=A,y=var)
)+labs(y=covars[j],x=NULL
)+geom_text(label=as.character(round(Acorr,digits=3)),
x=0.85*max(plotDF$A,na.rm=TRUE),
y=(5*(max(plotDF$var,na.rm=TRUE)-min(plotDF$var,na.rm=TRUE)))+min(plotDF$var,na.rm=TRUE),
color="blue",
size=3.5)
CplotList[[covars[j]]] = ggplot(plotDF
)+geom_point(aes(x=C,y=var)
)+labs(y=covars[j],x=NULL
)+geom_text(label=as.character(round(Ccorr,digits=3)),
x=0.85*max(plotDF$C,na.rm=TRUE),
y=(5*(max(plotDF$var,na.rm=TRUE)-min(plotDF$var,na.rm=TRUE)))+min(plotDF$var,na.rm=TRUE),
color="blue",
size=3.5)
AplotListAnom[[covars[j]]] = ggplot(plotDFAnom
)+geom_point(aes(x=A,y=anom)
)+labs(y=covars[j],x=NULL
)+geom_text(label=as.character(round(AcorrAnom,digits=3)),
x=0.85*max(plotDFAnom$A,na.rm=TRUE),
y=(5*(max(plotDFAnom$anom,na.rm=TRUE)-min(plotDFAnom$anom,na.rm=TRUE)))+min(plotDFAnom$anom,na.rm=TRUE),
color="blue",
size=3.5)
CplotListAnom[[covars[j]]] = ggplot(plotDFAnom
)+geom_point(aes(x=C,y=anom)
)+labs(y=covars[j],x=NULL
)+geom_text(label=as.character(round(CcorrAnom,digits=3)),
x=0.85*max(plotDFAnom$C,na.rm=TRUE),
y=(5*(max(plotDFAnom$anom,na.rm=TRUE)-min(plotDFAnom$anom,na.rm=TRUE)))+min(plotDFAnom$anom,na.rm=TRUE),
color="blue",
size=3.5)
}
png(file=paste(getwd(),'/EcologicalNichePlots/',sites[i],'_AEddyInfluence.png',sep=""),height=700,width=600,units="px",res=100)
grid.arrange(grobs=AplotList,ncol=2,nrow=5,top=sites[i])
while (dev.cur()>1) {dev.off()}
png(file=paste(getwd(),'/EcologicalNichePlots/',sites[i],'_CEddyInfluence.png',sep=""),height=700,width=600,units="px",res=100)
grid.arrange(grobs=CplotList,ncol=2,nrow=5,top=sites[i])
while (dev.cur()>1) {dev.off()}
png(file=paste(getwd(),'/EcologicalNichePlots/',sites[i],'_AEddyInfluence_Anom.png',sep=""),height=700,width=600,units="px",res=100)
grid.arrange(grobs=AplotListAnom,ncol=2,nrow=5,top=sites[i])
while (dev.cur()>1) {dev.off()}
png(file=paste(getwd(),'/EcologicalNichePlots/',sites[i],'_CEddyInfluence_Anom.png',sep=""),height=700,width=600,units="px",res=100)
grid.arrange(grobs=CplotListAnom,ncol=2,nrow=5,top=sites[i])
while (dev.cur()>1) {dev.off()}
}
max(plotDF$var,na.rm=TRUE)
covars[j]
min(plotDF$var,na.rm=TRUE)
5*(max(plotDF$var,na.rm=TRUE)-min(plotDF$var,na.rm=TRUE)))
5*(max(plotDF$var,na.rm=TRUE)-min(plotDF$var,na.rm=TRUE))
sites = unique(weeklyDF$Site)
covars = c("Chl0","EKE0","FSLE0","SSH0","Temp0","Sal0",
"VelMag0","VelAsp0")
ACorrMat = matrix(nrow=length(sites),ncol=length(covars))
CCorrMat = matrix(nrow=length(sites),ncol=length(covars))
ACorrMatAn = matrix(nrow=length(sites),ncol=length(covars))
CCorrMatAn = matrix(nrow=length(sites),ncol=length(covars))
for (i in 1:length(sites)){
siteInd = which(weeklyDF$Site==sites[i])
AplotList = list()
CplotList = list()
AplotListAnom = list()
CplotListAnom = list()
for (j in 1:length(covars)){
if (covars[j]!="EKE0"){ # don't calculate anomaly for EKE (it's already an anomaly)
varMean = rollmean(weeklyDF[[covars[j]]][siteInd],k=5)
varAnom = weeklyDF[[covars[j]]][siteInd] - c(NA,NA,varMean,NA,NA)
} else {
varAnom = weeklyDF[[covars[j]]][siteInd]
}
plotDF = data.frame(var=weeklyDF[[covars[j]]][siteInd],A=weeklyDF$AEddyDist0[siteInd],C=weeklyDF$CEddyDist0[siteInd])
Acorr = cor(plotDF$var,plotDF$A,use="complete.obs")
ACorrMat[i,j] = round(Acorr,digits=4)
Ccorr = cor(plotDF$var,plotDF$C,use="complete.obs")
CCorrMat[i,j] = round(Ccorr,digits=4)
plotDFAnom = data.frame(anom=varAnom,A=weeklyDF$AEddyDist0[siteInd],C=weeklyDF$CEddyDist0[siteInd])
AcorrAnom = cor(plotDFAnom$anom,plotDFAnom$A,use="complete.obs")
ACorrMatAn[i,j] = round(AcorrAnom,digits=4)
CcorrAnom = cor(plotDFAnom$anom,plotDFAnom$C,use="complete.obs")
CCorrMatAn[i,j] = round(CcorrAnom,digits=4)
AplotList[[covars[j]]] = ggplot(plotDF
)+geom_point(aes(x=A,y=var)
)+labs(y=covars[j],x=NULL
)+geom_text(label=as.character(round(Acorr,digits=3)),
x=0.85*max(plotDF$A,na.rm=TRUE),
y=(0.5*(max(plotDF$var,na.rm=TRUE)-min(plotDF$var,na.rm=TRUE)))+min(plotDF$var,na.rm=TRUE),
color="blue",
size=3.5)
CplotList[[covars[j]]] = ggplot(plotDF
)+geom_point(aes(x=C,y=var)
)+labs(y=covars[j],x=NULL
)+geom_text(label=as.character(round(Ccorr,digits=3)),
x=0.85*max(plotDF$C,na.rm=TRUE),
y=(0.5*(max(plotDF$var,na.rm=TRUE)-min(plotDF$var,na.rm=TRUE)))+min(plotDF$var,na.rm=TRUE),
color="blue",
size=3.5)
AplotListAnom[[covars[j]]] = ggplot(plotDFAnom
)+geom_point(aes(x=A,y=anom)
)+labs(y=covars[j],x=NULL
)+geom_text(label=as.character(round(AcorrAnom,digits=3)),
x=0.85*max(plotDFAnom$A,na.rm=TRUE),
y=(0.5*(max(plotDFAnom$anom,na.rm=TRUE)-min(plotDFAnom$anom,na.rm=TRUE)))+min(plotDFAnom$anom,na.rm=TRUE),
color="blue",
size=3.5)
CplotListAnom[[covars[j]]] = ggplot(plotDFAnom
)+geom_point(aes(x=C,y=anom)
)+labs(y=covars[j],x=NULL
)+geom_text(label=as.character(round(CcorrAnom,digits=3)),
x=0.85*max(plotDFAnom$C,na.rm=TRUE),
y=(0.5*(max(plotDFAnom$anom,na.rm=TRUE)-min(plotDFAnom$anom,na.rm=TRUE)))+min(plotDFAnom$anom,na.rm=TRUE),
color="blue",
size=3.5)
}
png(file=paste(getwd(),'/EcologicalNichePlots/',sites[i],'_AEddyInfluence.png',sep=""),height=700,width=600,units="px",res=100)
grid.arrange(grobs=AplotList,ncol=2,nrow=5,top=sites[i])
while (dev.cur()>1) {dev.off()}
png(file=paste(getwd(),'/EcologicalNichePlots/',sites[i],'_CEddyInfluence.png',sep=""),height=700,width=600,units="px",res=100)
grid.arrange(grobs=CplotList,ncol=2,nrow=5,top=sites[i])
while (dev.cur()>1) {dev.off()}
png(file=paste(getwd(),'/EcologicalNichePlots/',sites[i],'_AEddyInfluence_Anom.png',sep=""),height=700,width=600,units="px",res=100)
grid.arrange(grobs=AplotListAnom,ncol=2,nrow=5,top=sites[i])
while (dev.cur()>1) {dev.off()}
png(file=paste(getwd(),'/EcologicalNichePlots/',sites[i],'_CEddyInfluence_Anom.png',sep=""),height=700,width=600,units="px",res=100)
grid.arrange(grobs=CplotListAnom,ncol=2,nrow=5,top=sites[i])
while (dev.cur()>1) {dev.off()}
}
sites = unique(weeklyDF$Site)
covars = c("Chl0","EKE0","FSLE0","SSH0","Temp0","Sal0",
"VelMag0","VelAsp0")
ACorrMat = matrix(nrow=length(sites),ncol=length(covars))
CCorrMat = matrix(nrow=length(sites),ncol=length(covars))
ACorrMatAn = matrix(nrow=length(sites),ncol=length(covars))
CCorrMatAn = matrix(nrow=length(sites),ncol=length(covars))
for (i in 1:length(sites)){
siteInd = which(weeklyDF$Site==sites[i])
AplotList = list()
CplotList = list()
AplotListAnom = list()
CplotListAnom = list()
for (j in 1:length(covars)){
if (covars[j]!="EKE0"){ # don't calculate anomaly for EKE (it's already an anomaly)
varMean = rollmean(weeklyDF[[covars[j]]][siteInd],k=5)
varAnom = weeklyDF[[covars[j]]][siteInd] - c(NA,NA,varMean,NA,NA)
} else {
varAnom = weeklyDF[[covars[j]]][siteInd]
}
plotDF = data.frame(var=weeklyDF[[covars[j]]][siteInd],A=weeklyDF$AEddyDist0[siteInd],C=weeklyDF$CEddyDist0[siteInd])
Acorr = cor(plotDF$var,plotDF$A,use="complete.obs")
ACorrMat[i,j] = round(Acorr,digits=4)
Ccorr = cor(plotDF$var,plotDF$C,use="complete.obs")
CCorrMat[i,j] = round(Ccorr,digits=4)
plotDFAnom = data.frame(anom=varAnom,A=weeklyDF$AEddyDist0[siteInd],C=weeklyDF$CEddyDist0[siteInd])
AcorrAnom = cor(plotDFAnom$anom,plotDFAnom$A,use="complete.obs")
ACorrMatAn[i,j] = round(AcorrAnom,digits=4)
CcorrAnom = cor(plotDFAnom$anom,plotDFAnom$C,use="complete.obs")
CCorrMatAn[i,j] = round(CcorrAnom,digits=4)
AplotList[[covars[j]]] = ggplot(plotDF
)+geom_point(aes(x=A,y=var)
)+labs(y=covars[j],x=NULL
)+annotate("text",
label=as.character(round(Acorr,digits=3)),
x=0.85*max(plotDF$A,na.rm=TRUE),
y=(0.5*(max(plotDF$var,na.rm=TRUE)-min(plotDF$var,na.rm=TRUE)))+min(plotDF$var,na.rm=TRUE),
color="blue",
size=3.5)
CplotList[[covars[j]]] = ggplot(plotDF
)+geom_point(aes(x=C,y=var)
)+labs(y=covars[j],x=NULL
)+annotate("text",
label=as.character(round(Ccorr,digits=3)),
x=0.85*max(plotDF$C,na.rm=TRUE),
y=(0.5*(max(plotDF$var,na.rm=TRUE)-min(plotDF$var,na.rm=TRUE)))+min(plotDF$var,na.rm=TRUE),
color="blue",
size=3.5)
AplotListAnom[[covars[j]]] = ggplot(plotDFAnom
)+geom_point(aes(x=A,y=anom)
)+labs(y=covars[j],x=NULL
)+annotate("text",
label=as.character(round(AcorrAnom,digits=3)),
x=0.85*max(plotDFAnom$A,na.rm=TRUE),
y=(0.5*(max(plotDFAnom$anom,na.rm=TRUE)-min(plotDFAnom$anom,na.rm=TRUE)))+min(plotDFAnom$anom,na.rm=TRUE),
color="blue",
size=3.5)
CplotListAnom[[covars[j]]] = ggplot(plotDFAnom
)+geom_point(aes(x=C,y=anom)
)+labs(y=covars[j],x=NULL
)+annotate("text",
label=as.character(round(CcorrAnom,digits=3)),
x=0.85*max(plotDFAnom$C,na.rm=TRUE),
y=(0.5*(max(plotDFAnom$anom,na.rm=TRUE)-min(plotDFAnom$anom,na.rm=TRUE)))+min(plotDFAnom$anom,na.rm=TRUE),
color="blue",
size=3.5)
}
png(file=paste(getwd(),'/EcologicalNichePlots/',sites[i],'_AEddyInfluence.png',sep=""),height=700,width=600,units="px",res=100)
grid.arrange(grobs=AplotList,ncol=2,nrow=5,top=sites[i])
while (dev.cur()>1) {dev.off()}
png(file=paste(getwd(),'/EcologicalNichePlots/',sites[i],'_CEddyInfluence.png',sep=""),height=700,width=600,units="px",res=100)
grid.arrange(grobs=CplotList,ncol=2,nrow=5,top=sites[i])
while (dev.cur()>1) {dev.off()}
png(file=paste(getwd(),'/EcologicalNichePlots/',sites[i],'_AEddyInfluence_Anom.png',sep=""),height=700,width=600,units="px",res=100)
grid.arrange(grobs=AplotListAnom,ncol=2,nrow=5,top=sites[i])
while (dev.cur()>1) {dev.off()}
png(file=paste(getwd(),'/EcologicalNichePlots/',sites[i],'_CEddyInfluence_Anom.png',sep=""),height=700,width=600,units="px",res=100)
grid.arrange(grobs=CplotListAnom,ncol=2,nrow=5,top=sites[i])
while (dev.cur()>1) {dev.off()}
}
View(masterDF)
plot(masterDF$VelMag0)
covars = c("Chl0","EKE0","FSLE0","SSH0","Temp0","Temp700","Sal0","Sal700",
"VelMag0","VelAsp0","CEddyDist0","AEddyDist0")
# specs = cbind(c("Blainville","Cuvier","Gervais","Kogia","Risso","Sowerby","SpermWhale","True","UD26","UD28"),
#               c("Md","Zc","Me","Kg","Gg","Mb","Pm","Mm","Gm","Dd"))
specs = cbind(c("UD28","Risso","UD26","Blainville","Gervais","Cuvier","Sowerby","True","Kogia","SpermWhale"),
c("Dd","Gg","Gm","Md","Me","Zc","Mb","Mm","Kg","Pm"))
i=1
plotDF = list()
for (j in 1:dim(specs)[1]){
presVals = as.numeric(masterDF[[covars[i]]][(masterDF[[specs[j,2]]]>0 & !is.na(masterDF[[specs[j,2]]]))])
# plotDF = rbind(plotDF,cbind(presVals,rep(j,length(presVals))))
plotDF[[specs[j,2]]] = presVals
}
plotDF = data.frame(stack(plotDF))
out = plotDF %>%
group_by(ind) %>%
identify_outliers("values")
if (numel(out!=0)){
out = out[,-c(3,4)]
outInd = which(!is.na(match_row(out,plotDF)))
plotDF = plotDF[-outInd,]
}
plotDF = list()
for (j in 1:dim(specs)[1]){
presVals = as.numeric(masterDF[[covars[i]]][(masterDF[[specs[j,2]]]>0 & !is.na(masterDF[[specs[j,2]]]))])
# plotDF = rbind(plotDF,cbind(presVals,rep(j,length(presVals))))
plotDF[[specs[j,2]]] = presVals
}
plotDF = data.frame(stack(plotDF))
ggplot(plotDF,
aes(x=ind,y=values,color=ind)
)+geom_violin(scale="area",
draw_quantiles=c(0.25, 0.5, 0.75)
)+labs(x="Species",
y=covars[i]
)+theme(legend.position="none")
ggplot(plotDF,
aes(x=ind,y=values,color=ind),
trim=TRUE
)+geom_violin(scale="area",
draw_quantiles=c(0.25, 0.5, 0.75)
)+labs(x="Species",
y=covars[i]
)+theme(legend.position="none")
i=9
plotDF = list()
for (j in 1:dim(specs)[1]){
presVals = as.numeric(masterDF[[covars[i]]][(masterDF[[specs[j,2]]]>0 & !is.na(masterDF[[specs[j,2]]]))])
# plotDF = rbind(plotDF,cbind(presVals,rep(j,length(presVals))))
plotDF[[specs[j,2]]] = presVals
}
plotDF = data.frame(stack(plotDF))
ggplot(plotDF,
aes(x=ind,y=values,color=ind),
trim=TRUE
)+geom_violin(scale="area",
draw_quantiles=c(0.25, 0.5, 0.75)
)+labs(x="Species",
y=covars[i]
)+theme(legend.position="none")
for (i in 1:length(covars)){
plotDF = list()
for (j in 1:dim(specs)[1]){
presVals = as.numeric(masterDF[[covars[i]]][(masterDF[[specs[j,2]]]>0 & !is.na(masterDF[[specs[j,2]]]))])
# plotDF = rbind(plotDF,cbind(presVals,rep(j,length(presVals))))
plotDF[[specs[j,2]]] = presVals
}
plotDF = data.frame(stack(plotDF))
ggplot(plotDF,
aes(x=ind,y=values,color=ind),
trim=TRUE
)+geom_violin(scale="area",
draw_quantiles=c(0.25, 0.5, 0.75)
)+labs(x="Species",
y=covars[i]
)+theme(legend.position="none")
ggsave(filename=paste(getwd(),'/EcologicalNichePlots/',covars[i],"_SpeciesPresDensity.png",sep=""),
device="png",
width=600,
height=300,
units="px",
scale=2.5)
}
# perform k-means clustering
K = kmeans(trainDat,centers=7,nstart=25)
# plot, coding by site and cluster
plot(K, data=masterDF[,2:14], class="Site")
# perform k-means clustering
K = kmeans(trainDat,centers=3,nstart=25)
# plot, coding by site and cluster
plot(K, data=masterDF[,2:14], class="Site")
pc = prcomp(trainDat,center=TRUE,scale=TRUE)
install.packages("ggbiplot")
library(ggbiplot)
